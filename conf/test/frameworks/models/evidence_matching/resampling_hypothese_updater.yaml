defaults:
  - /experiment/config/supervised_pretraining@config
  - /experiment/config/logging/clear_logging@config
  - /experiment/config/logging/pretrain@config.logging
  - /experiment/config/monty/clear_monty_config@config
  - /experiment/config/monty/patch_and_view@config.monty_config
  - /experiment/config/monty/args/clear_monty_args@config.monty_config
  - /experiment/config/monty/args/feature_graph@config.monty_config.monty_args
  - /experiment/config/monty/learning_modules/clear_learning_module_configs@config.monty_config
  - /experiment/config/environment/clear_env_interface_config@config
  - /experiment/config/environment/patch_view_finder_mount_habitat@config.env_interface_config
  - /experiment/config/environment/init_args/clear_env_init_args@config.env_interface_config
  - /experiment/config/environment/init_args/patch_view_mount@config.env_interface_config.env_init_args
  - /experiment/config/environment_interface/clear_train_env_interface_args@config
  - /experiment/config/environment_interface/per_object_train@config.train_env_interface_args


_target_: tbp.monty.frameworks.experiments.pretraining_experiments.MontySupervisedObjectPretrainingExperiment
config:
  n_train_epochs: 3
  monty_config:
    monty_class: ${monty.class:tbp.monty.frameworks.models.evidence_matching.model.MontyForEvidenceGraphMatching}
    monty_args:
      num_exploratory_steps: 20
    learning_module_configs:
      learning_module_0:
        learning_module_class: ${monty.class:tbp.monty.frameworks.models.evidence_matching.learning_module.EvidenceGraphLM}
        learning_module_args:
          max_match_distance: 0.001
          tolerances:
            patch:
              hsv: ${np.array:[0.1, 1, 1]}
              principal_curvatures_log: ${np.ones:2}
          feature_weights:
            patch:
              hsv: ${np.array:[1, 0, 0]}
          hypotheses_updater_class: ${monty.class:tbp.monty.frameworks.models.evidence_matching.resampling_hypotheses_updater.ResamplingHypothesesUpdater}
  env_interface_config:
    env_init_args:
      data_path: null
  train_env_interface_class: ${monty.class:tbp.monty.frameworks.environments.embodied_data.InformedEnvironmentInterface}
  train_env_interface_args:
    object_names:
      - capsule3DSolid
    object_init_sampler:
      _target_: tbp.monty.frameworks.config_utils.make_env_interface_configs.PredefinedObjectInitializer
